# RDBMS와 JPA 연관관계 매핑

RDBMS를 사용할 때는 테이블 하나만 사용해서 애플리케이션의 모든 기능을 구현하기란 불가능합니다. 각 도메인에 맞는 테이블을 설계하고 연관관계를 설정해서 조인 등의 기능을 활용합니다. JPA를 사용하는 애플리케이션에서도 테이블의 연관관계를 엔티티 간의 연관관계로 표현할 수 있습니다.

## 9.1 연관관계 매핑 종류와 방향

- One To One: 일대일(1:1)
- One To Many: 일대다(1:N)
- Many To One: 다대일(N:1)
- Many To Many: 다대다(N:M)

어떤 엔티티를 중심으로 연관 엔티티를 보느냐에 따라 연관관계의 상태가 달라집니다. 데이터베이스에는 두 테이블의 연관관계를 설정하면 외래키를 통해 서로 조인해서 참조하는 구조로 생성되지만 JPA를 사용하는 객체지향 모델링에서는 엔티티 간 참조 방향을 설정할 수 있습니다. 데이터베이스와 관계를 일치시키기 위해 양방향으로 설정해도 무관하지만 **비지니스 로직의 관점에서 봤을 때는 단방향 관계만으로 설정해도 해결되는 경우가 많습니다.**

### 단방향과 양방향 관계란

단방향은 두 엔티티의 관계에서 한쪽의 엔티티만 참조하는 형식입니다. 양방향은 두 엔티티의 관계에서 각 엔티티가 서로의 엔티티를 참조하는 형식입니다.

연관관계가 설정되면 한 테이블에서 다른 테이블의 기본값을 외래키로 갖게 됩니다. 일반적으로 외래키를 가진 테이블이 그 관계의 주인이 되며, 주인은 외래키를 사용할 수 있으나 상태 엔티티는 읽기 작업만 수행할 수 있습니다.


## 9.3 일대일 매핑
@OneToOne 어노테이션은 다른 엔티티 객체를 필드로 정의했을 때 일대일 연관관계 매핑하기 위해 사용됩니다. 뒤이어 @joinColumn 어노테이션을 사용해 매핑할 외래키를 설정합니다.@JoinColumn 어노테이션은 기본값이 설정돼 있어 자동으로 이름을 매핑하지만 의도한 이름이 들어가지 않기 때문에 name 속성을 사용해 원하는 칼럼명을 지정하는 것이 좋습니다.
만약, @JoinColumn을 선언하지 않으면 엔티티를 매핑하는 중간 테이블이 생기면서 관리 포인트가 늘어나서 좋지 않습니다.
```
@OneToOne
@JoinColumn(name = "")
name: 매핑할 외래키의 이름을 설정
referencedColumnName: 외래키가 참조할 상대 테이블의 칼럼명
foreignKey: 외래키를 생성하면서 지정할 제약조건을 설정합니다.(unique, nullable,insertable,updatable 등)
```
@OneToOne 어노테이션은 기본 fetch 전략으로 EAGER, 즉시 로딩 전얅이 채택되어 있습니다. 그리고 optional() 메서드는 기본값으로 true가 설정돼 있습니다. 기본값이 true인 상태는 매핑되는 값이 nullable이라는 것을 읨합니다. 반드시 값이 있어야 한다면 @OneToOne 어노테이션에 'optional = false' 속성을 설정하면 null 값을 허용하지 않게 됩니다.

